<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Home</title>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded"/>
	<link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/catalogo.css">
    <script src="/js/sidebar.js" defer></script>
</head>
<body>
	<header>
		<span class="material-symbols-rounded" onclick="toggleSidebar()">dehaze</span>
		<h1><a href="/">Catalogo Prodotti</a></h1>
	</header>
	<!-- Sidebar primaria -->
	<div id="sidebar" class="sidebar">
		<a href="javascript:void(0)" class="closebtn" onclick="toggleSidebar()"><span class="material-symbols-rounded">close</span></a>
		<p>Naviga per:</p>
		<div class="sidebar-item" data-submenu="tipologie">Tipologia <span class="material-symbols-rounded">chevron_right</span></div>
		<div class="sidebar-item" data-submenu="marche">Marca <span class="material-symbols-rounded">chevron_right</span></div>
		<div class="sidebar-item" data-submenu="anni">Anno <span class="material-symbols-rounded">chevron_right</span></div>
		<div class="sidebar-item">
			<a th:href="@{/prodotti}" style="padding: 0;">Tutti i prodotti</a>
		</div>
	</div>
	<!-- Sidebar secondaria -->
	<div id="sidebar-secondary" class="sidebar sidebar-secondary" aria-hidden="true">
		<div class="secondary-inner">
			<!-- Tipologie -->
			<div class="submenu" id="submenu-tipologie">
				<a th:each="tip : ${tipologie}" th:href="@{'/tipologia/' + ${tip.toLowerCase()}}" th:text="${tip.toLowerCase() == 'tv' ? tip.toUpperCase() : #strings.capitalizeWords(tip.toLowerCase())}">Tipologia</a>
			</div>
			<!-- Marche -->
			<div class="submenu" id="submenu-marche">
				<a th:each="marca : ${marche}" th:href="@{'/marca/' + ${marca.toLowerCase()}}" th:text="${marca.toLowerCase() == 'hp' || marca.toLowerCase() == 'lg' || marca.toLowerCase() == 'tcl' ? marca.toUpperCase() : #strings.capitalizeWords(marca.toLowerCase())}">Marca</a>
			</div>
			<!-- Anni -->
			<div class="submenu" id="submenu-anni">
				<a th:each="anno : ${anni}" th:href="@{'/anno/' + ${anno}}" th:text="${anno}">Anno</a>
			</div>
		</div>
	</div>
    <!-- Barra di navigazione -->
	<nav class="tipologie-nav">
        <!-- Link per ogni tipologia -->
		<a th:each="tipologia : ${tipologie}" th:href="@{'/tipologia/' + ${tipologia.toLowerCase()}}" th:text="${tipologia.toLowerCase() == 'tv' ? tipologia.toUpperCase() : #strings.capitalizeWords(tipologia.toLowerCase())}">Tipologia</a>
	</nav>
	<main>
		<div th:each="tipologiaEntry : ${catalogo}" class="tipologia-block">
            <div style="display: flex; align-items: center;">
                <h2 th:text="${tipologiaEntry.key}"></h2>
                <span class="toggleTipologia material-symbols-rounded">expand_more</span>
            </div>

            <div class="prodotti-list" th:each="marcaEntry : ${tipologiaEntry.value}">
                <h3 th:text="${marcaEntry.key}"></h3>
                <ul>
                    <li th:each="prodotto : ${marcaEntry.value}">
                        <a th:href="@{'/prodotti/' + ${prodotto.id}}"
                        th:text="${prodotto.nome}"></a>
                    </li>
                </ul>
            </div>
        </div>
	</main>
	<footer>
		<p>&copy; 2025 Catalogo Prodotti</p>
		<p>Progetto assegnato dal docente per il corso di Sistemi Informativi su Web - appello di settembre</p>
		<p>Realizzato da <strong>Luca Monaco</strong> | <a href="mailto:luca.monaco04@icloud.com">Contattami</a> | <a href="https://github.com/lumon2004/catalogo-prodotti" target="_blank">GitHub</a></p>
    </footer>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const toggles = document.querySelectorAll('.toggleTipologia');

            toggles.forEach(toggleIcon => {
                toggleIcon.addEventListener('click', function () {
                    // Prendo il blocco della tipologia corrente
                    const tipologiaBlock = toggleIcon.closest('.tipologia-block');
                    // Prendo tutte le liste prodotti sotto a quella tipologia
                    const prodottiLists = tipologiaBlock.querySelectorAll('.prodotti-list');

                    prodottiLists.forEach(list => {
                        const isVisible = list.style.display !== 'none';
                        list.style.display = isVisible ? 'none' : 'block';
                    });

                    toggleIcon.classList.toggle('rotated');
                });
            });
        });
    </script>
</body>
</html>